<div class="form-container">
<%= render "posts/rev_form"%>
</div>


<% if @posts.empty? %>
  <% no_rev_msg = (current_user)? "No posts yet, #{link_to 'write the first one', nil, class:'open-post-form'}!" : "No posts yet, #{link_to 'Sign up', sign_up_path } or #{link_to 'log in', log_in_path } to leave the first!";%>

  <p class="center-warning"><%= no_rev_msg.html_safe %></p>
<% else %>
  <% if current_user and !contains_user(@posts,current_user) %>
    <a href="#" class="open-post-form fade-open-post">Write a post</a>
  <% end %>


  <div id="posts">
  <% @posts.reverse.each do |post| %>
    <div class="review">
      <div class="review-user">
        <a href="<%= user_path(post.user) %>">
          <%= user_gravatar(post.user, 80) %>
          <span class="review-username"><%= post.user.username %></span>
        </a>
      </div>
      <div class="review-content">
        
        <div class="review-text">
          <%= simple_format(post.content) %>
        </div>
      </div>

      <div class="review-meta">
        <span>Posted <%= time_ago_in_words(post.created_at) %> ago</span><% if user_admin?(current_user) || post.user == current_user %> | <%= link_to 'Destroy', polymorphic_path(@parent)+"/#{post.id}", method: :delete, data: { confirm: 'Are you sure?' } %> <% end %>
      </div>
    </div>
  <% end %>

  <% unless current_user %>
    <p class="center-warning"><%= link_to 'Sign up', sign_up_path %> or <%= link_to 'log in', log_in_path %> to write a post</p>
  <% end %> 

  </div>
<% end %>